package hadoop;

import java.io.FileInputStream;
import java.io.InputStream;
import java.io.OutputStream;

import org.apache.hadoop.conf.Configuration;
import org.apache.hadoop.fs.FileSystem;
import org.apache.hadoop.fs.Path;
import org.junit.Test;

public class TestUpload {
	@Test
	public void testMkdir() throws Exception{
		System.setProperty("HADOOP_USER_NAME", "root");
		Configuration conf = new Configuration();
		conf.set("fs.defaultFS", "hdfs://192.168.118.113:9000");
		
		FileSystem client = FileSystem.get(conf);
		InputStream input = new FileInputStream("C:\\Users\\xinyu\\Dropbox\\gg\\Job_hunting\\big data\\BigData");
		OutputStream output = client.create(new Path("/folder113"));
		
		byte[] buffer = new byte[1024];
		int len = 0;
		while((len=input.read(buffer)) > 0) {
			output.write(buffer,0,len);
		}
		output.flush();
		input.close();
		output.close();
		client.close();
	}	
}
